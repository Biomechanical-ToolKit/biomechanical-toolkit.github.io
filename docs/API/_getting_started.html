<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>BTK: Getting started</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="DoxygenStyleSheet_API.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BTK
   &#160;<span id="projectnumber">0.3dev.0</span>
   </div>
   <div id="projectbrief">Open-source library to visualize/process biomechanical data</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="classes.html"><span>Classes</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Getting started </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="btkmenu"><a class="el" href="index.html">Overview</a> | <a class="el" href="_build_instructions.html">Building instructions</a> | <b>Getting</b> <b>started</b> | <a class="el" href="_advanced_tutorial.html">Advanced tutorial</a> | <a class="el" href="_developer.html">Developer's guide</a> | <a class="el" href="_license.html">License</a> </div><h1><a class="anchor" id="TOC"></a>
Table of contents</h1>
<ul>
<li><a class="el" href="_getting_started.html#BTKIntegeration">Integrate BTK in your project</a></li>
<li><a class="el" href="_getting_started.html#ObjectCreation">Object creation and shared pointer</a></li>
<li><a class="el" href="_getting_started.html#AcquisitionReading">Reading an acquisition</a></li>
<li><a class="el" href="_getting_started.html#AcquisitionAccessing">Accessing acquisition's data</a></li>
<li><a class="el" href="_getting_started.html#AcquisitionModifying">Modifying acquisition's data</a></li>
<li><a class="el" href="_getting_started.html#AcquisitionWriting">Writing an acquisition</a></li>
<li><a class="el" href="_getting_started.html#AcquisitionFiltering">Filtering an acquisition</a></li>
</ul>
 <hr> <h1><a class="anchor" id="BTKIntegeration"></a>
Integrate BTK in your project</h1>
<p>The simplest way to integrate BTK in your programs is to use the file <code>FindBTK.cmake</code> included with the source code in the <code>CMake</code> folder or in the subfolder <code>share/CMake</code> if you use a binary release. This file will be used by <em>CMake</em> to find the include path, the libraries and all resources required to used BTK as an external library in you program.</p>
<p>For example, the file <code>CMakeLists.txt</code> used to compile the example <code>AcquisitionConverted</code> (see the folder <code>/Examples/AcquisitionConverter</code> in the sources) can be easily modify to be built as an external project and integrating BTK.</p>
<p>Old <code>CMakeLists.txt</code> file used to build the example <code>AcquisitionConverter</code> when compiling BTK: </p>
<div class="fragment"><div class="line">SET(AcquisitionConverter_SRCS main.cpp)</div>
<div class="line">ADD_EXECUTABLE(AcquisitionConverter ${AcquisitionConverter_SRCS})</div>
<div class="line">TARGET_LINK_LIBRARIES(AcquisitionConverter BTKIO)</div>
</div><!-- fragment --><p>New <code>CMakeLists.txt</code> file to build <code>AcquisitionConverter</code> as an independent project: </p>
<div class="fragment"><div class="line">PROJECT(AcquisitionConverter)</div>
<div class="line">CMAKE_MINIMUM_REQUIRED(VERSION 2.6.2)</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Used to find the file FindBTK.cmake</span></div>
<div class="line"><span class="preprocessor"></span>SET(CMAKE_MODULE_PATH ${AcquisitionConverter_SOURCE_DIR})</div>
<div class="line"></div>
<div class="line"># The required lines to use FindBTK.cmake in you project</div>
<div class="line">FIND_PACKAGE(BTK REQUIRED)</div>
<div class="line">INCLUDE(${BTK_USE_FILE})</div>
<div class="line"></div>
<div class="line">SET(AcquisitionConverter_SRCS main.cpp)</div>
<div class="line">ADD_EXECUTABLE(AcquisitionConverter ${AcquisitionConverter_SRCS})</div>
<div class="line">TARGET_LINK_LIBRARIES(AcquisitionConverter BTKIO)</div>
</div><!-- fragment --><h1><a class="anchor" id="ObjectCreation"></a>
Object creation and shared pointer</h1>
<p>To simplify the way to code and manage the memory used by BTK, it is proposed to use shared pointer. A shared pointer is like a pointer but without owner. Its content is shared by all the variables assigned to the shared pointer and will be deleted when no variable use it anymore (meaning, the memory is freed automatically).</p>
<p>To do that the most transparent as possible, each class in BTK has the type definition <code>Pointer</code> and the static method(s) <code>New</code>. So you cannot instantiate an object by using a constructor but by using one of the <code>New</code> methods proposed in each class with return a <code>Pointer</code> (i.e. a shared pointer). So, to create a object <a class="el" href="classbtk_1_1_acquisition.html" title="Contains the data related to a biomechanical acquisition. ">btk::Acquisition</a> (or strictly speaking a shared pointer associated with a <a class="el" href="classbtk_1_1_acquisition.html" title="Contains the data related to a biomechanical acquisition. ">btk::Acquisition</a> object), you can use the following code: </p>
<div class="fragment"><div class="line"><a class="code" href="classbtk_1_1_acquisition.html#a121cd3751db496acdc3673fbe87da6e1">btk::Acquisition::Pointer</a> acq = <a class="code" href="classbtk_1_1_acquisition.html#a7cdb753631d27ae8057a67f0f5c4f0dd">btk::Acquisition::New</a>();</div>
</div><!-- fragment --><p> By using this code, you create a new shared pointer assigned to the variable <code>acq</code>. If you use a second variable and assign it to the first one, then the modification done by one is reflected in the other (as a regular pointer). </p>
<div class="fragment"><div class="line"><a class="code" href="classbtk_1_1_acquisition.html#a121cd3751db496acdc3673fbe87da6e1">btk::Acquisition::Pointer</a> foo = acq; <span class="comment">// Shallow copy</span></div>
<div class="line">std::cout &lt;&lt; acq-&gt;GetFirstFrame() &lt;&lt; std::end; <span class="comment">// 1</span></div>
<div class="line">foo-&gt;SetFirstFrame(10);</div>
<div class="line">std::cout &lt;&lt; acq-&gt;GetFirstFrame() &lt;&lt; std::end; <span class="comment">// 10</span></div>
</div><!-- fragment --><p> The main difference compared to a regular pointer is when you use the <code>delete</code> function (or used implicitly in the class' destructor). If you delete the content of <code>acq</code>, then you can use again the variable <code>foo</code> to access/modify the acquisition. In the case of a regular pointer, this behavior is not possible and will crash your application. </p>
<div class="fragment"><div class="line"><span class="keyword">delete</span> acq;</div>
<div class="line">std::cout &lt;&lt; foo-&gt;GetFirstFrame() &lt;&lt; std::end; <span class="comment">// 10</span></div>
<div class="line"><span class="comment">// Memory will be freed automaticaly at the end of the function. No need to use the keyword delete </span></div>
</div><!-- fragment --><p> The only way to copy (or more exactly to create a deep copy) of the object is to use the method <code>Clone</code>. </p>
<div class="fragment"><div class="line"><a class="code" href="classbtk_1_1_acquisition.html#a121cd3751db496acdc3673fbe87da6e1">btk::Acquisition::Pointer</a> acq = <a class="code" href="classbtk_1_1_acquisition.html#a7cdb753631d27ae8057a67f0f5c4f0dd">btk::Acquisition::New</a>();</div>
<div class="line"><a class="code" href="classbtk_1_1_acquisition.html#a121cd3751db496acdc3673fbe87da6e1">btk::Acquisition::Pointer</a> foo = acq-&gt;Clone(); <span class="comment">// Deep copy</span></div>
<div class="line">std::cout &lt;&lt; acq-&gt;GetFirstFrame() &lt;&lt; std::end; <span class="comment">// 1</span></div>
<div class="line">foo-&gt;SetFirstFrame(10);</div>
<div class="line">std::cout &lt;&lt; acq-&gt;GetFirstFrame() &lt;&lt; std::end; <span class="comment">// 1</span></div>
<div class="line">std::cout &lt;&lt; foo-&gt;GetFirstFrame() &lt;&lt; std::end; <span class="comment">// 10</span></div>
<div class="line"><span class="comment">// Both, acq and foo will be freed at the end of the function.</span></div>
</div><!-- fragment --><p>This is the same thing when you use a shared pointer as an input/output variable in a function. You do not need to manage the memory of the shared pointer or think about the use of a reference. </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;btkAcquisition.h&gt;</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="classbtk_1_1_acquisition.html#a121cd3751db496acdc3673fbe87da6e1">btk::Acquisition::Pointer</a> defaultInit()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition.html#a121cd3751db496acdc3673fbe87da6e1">btk::Acquisition::Pointer</a> acq = <a class="code" href="classbtk_1_1_acquisition.html#a7cdb753631d27ae8057a67f0f5c4f0dd">btk::Acquisition::New</a>();</div>
<div class="line">  acq-&gt;Init(10,200,20,10); <span class="comment">// 10 points, 200 frames, 20 analog channels with a number of frames 10 times greater</span></div>
<div class="line">  acq-&gt;SetFrequency(100.0); <span class="comment">// 100 Hz. Analog&#39;s frequency is automatically set to 1000 Hz.</span></div>
<div class="line">  <span class="keywordflow">return</span> acq;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition.html#a121cd3751db496acdc3673fbe87da6e1">btk::Acquisition::Pointer</a> acq = defaultInit();</div>
<div class="line">  <span class="comment">// ...</span></div>
<div class="line">};</div>
</div><!-- fragment --><h1><a class="anchor" id="AcquisitionReading"></a>
Reading an acquisition</h1>
<p>The library BTK can read a dozen of acquisition files with the most popular, the C3D file format. All the known file format read and written in BTK are presented in this <a class="el" href="_file_format_supported.html#FileFormatSupported_Acquisition">page</a>.</p>
<p>To read an acquisition file you need to use the class <a class="el" href="classbtk_1_1_acquisition_file_reader.html" title="Reader for files which contain acquisition data (C3D, TRC, ...). ">btk::AcquisitionFileReader</a>. This class, embedded in the module BTKIO, is a process with one output: the read acquisition. </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;btkAcquisitionFileReader.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;btkAcquisition.h&gt;</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="classbtk_1_1_acquisition.html#a121cd3751db496acdc3673fbe87da6e1">btk::Acquisition::Pointer</a> readAcquisition(<span class="keyword">const</span> std::string&amp; filename)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a279d2865e41e3600c9b2bf2ff07c0289">btk::AcquisitionFileReader::Pointer</a> reader = <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a4c76c7df065bf3dd5e52be868aafae5a">btk::AcquisitionFileReader::New</a>();</div>
<div class="line">  reader-&gt;SetFilename(filename);</div>
<div class="line">  reader-&gt;Update();</div>
<div class="line">  <span class="keywordflow">return</span> reader-&gt;GetOutput();</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition.html#a121cd3751db496acdc3673fbe87da6e1">btk::Acquisition::Pointer</a> acq = readAcquisition(<span class="stringliteral">&quot;myFile.c3d&quot;</span>);</div>
<div class="line">  <span class="comment">// ...</span></div>
<div class="line">};</div>
</div><!-- fragment --><p>In the previous example, the selection of the file format is done automatically by checking the file's content and/or the file's extension. But, you can also force the file format to use. For that, you have to use the method AcquisitionFileReader::SetAcquisitionIO and give it the chosen file I/O. </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;btkAcquisitionFileReader.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;btkC3DFileIO.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;btkAcquisition.h&gt;</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="classbtk_1_1_acquisition.html#a121cd3751db496acdc3673fbe87da6e1">btk::Acquisition::Pointer</a> readC3D(<span class="keyword">const</span> std::string&amp; filename)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a279d2865e41e3600c9b2bf2ff07c0289">btk::AcquisitionFileReader::Pointer</a> reader = <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a4c76c7df065bf3dd5e52be868aafae5a">btk::AcquisitionFileReader::New</a>();</div>
<div class="line">  <a class="code" href="classbtk_1_1_c3_d_file_i_o.html#a936cc23637b91b8a43b95f0ed1d345c0">btk::C3DFileIO::Pointer</a> io = <a class="code" href="classbtk_1_1_c3_d_file_i_o.html#a2ef6af9d43cded077b747e88479854c8">btk::C3DFileIO::New</a>();</div>
<div class="line">  reader-&gt;SetAcquisitionIO(io); <span class="comment">// Will open the given file as a C3D file.</span></div>
<div class="line">  reader-&gt;SetFilename(filename);</div>
<div class="line">  reader-&gt;Update();</div>
<div class="line">  <span class="keywordflow">return</span> reader-&gt;GetOutput();</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition.html#a121cd3751db496acdc3673fbe87da6e1">btk::Acquisition::Pointer</a> acq = readC3D(<span class="stringliteral">&quot;myFile.foo&quot;</span>); <span class="comment">//  Will read the file as a C3D </span></div>
<div class="line">  <span class="comment">// ...</span></div>
<div class="line">};</div>
</div><!-- fragment --><p>All the IO classes are listed in the page <a class="el" href="_file_format_supported.html">Read and written files in BTK</a></p>
<h1><a class="anchor" id="AcquisitionAccessing"></a>
Accessing acquisition's data</h1>
<p>An acquisition (<a class="el" href="classbtk_1_1_acquisition.html" title="Contains the data related to a biomechanical acquisition. ">btk::Acquisition</a>) is mostly a generic container to store points (<a class="el" href="classbtk_1_1_point.html" title="Coordinates of a point in a 3D space along the time. ">btk::Point</a>), analog channels (<a class="el" href="classbtk_1_1_analog.html" title="Analog channel data along the time. ">btk::Analog</a>), events (<a class="el" href="classbtk_1_1_event.html" title="Label a specific time/frame during an acquisition. ">btk::Event</a>) and metadata (<a class="el" href="classbtk_1_1_meta_data.html" title="Store data which cannot be embedded within timeseries data (calibration matrix, subject informations...">btk::MetaData</a>). You can easily construct a new acquisition or load it from an acquisition file as shown in the above examples.</p>
<p>The others informations stored in an acquisition are the following:</p>
<ul>
<li>Index of the first frame;</li>
<li>Number of frames;</li>
<li>Number of analog samples per (video) frames.</li>
<li>Point (video) and analog frequencies;</li>
<li>Point's units;</li>
<li>Analog resolution (most common values are 12 of 16 bits).</li>
<li>Maximum interpolation gap.</li>
</ul>
<h2><a class="anchor" id="AcquisitionAccessing_Point"></a>
Accessing points</h2>
<p><b>Note:</b> In BTK, the term "point" means all data with 3 components along the time. So, a point can be also a force, a moment, a power, etc. Check <a class="el" href="classbtk_1_1_point.html#a1443ed9d3be803fae9d58b1d968c4834">btk::Point::GetType()</a> to know the point's type.</p>
<p>In an acquisition, points are stored in a <a class="el" href="classbtk_1_1_collection.html#a42e1941a717a8c7079f6f797f5f12068">btk::PointCollection::Pointer</a> object. To access to this collection, you can use the method <a class="el" href="classbtk_1_1_acquisition.html#a7859026acabad7ade41ec695a29da277">btk::Acquisition::GetPoints</a>.</p>
<p>To access to a point and its content, you can use the methods <a class="el" href="classbtk_1_1_acquisition.html#af5fd33b552370d547f6bf9a04a6e9f7f">btk::Acquisition::GetPoint()</a> which return a <a class="el" href="classbtk_1_1_point.html#a62f1ac02e5140017676b23d91c3dc631">btk::Point::Pointer</a> object based on the given index or label. If you give an invalid index or an invalid point's label, an exception (<a class="el" href="classbtk_1_1_out_of_range_exception.html" title="Out of range exception. ">btk::OutOfRangeException</a>) will be thrown.<br/>
Another way to access to the content of a specific point when you don't know it exist or not in the acquisition is to use the method <a class="el" href="classbtk_1_1_acquisition.html#a237e17bd99091fc7f905b3ec9a6095e0">btk::Acquisition::FindPoint()</a>. Given a point's label, this method returns an iterator associated to the found point. In the case the point is not found, the iterator will point to the end of the list of points. </p>
<div class="fragment"><div class="line"><span class="comment">// btk::Acquisition::Pointer acq = ...</span></div>
<div class="line"><a class="code" href="classbtk_1_1_point.html#a62f1ac02e5140017676b23d91c3dc631">btk::Point::Pointer</a> p = acq-&gt;GetPoint(0); <span class="comment">// First point in the acquisition</span></div>
<div class="line">std::cout &lt;&lt; p-&gt;GetLabel() &lt;&lt; std::endl;</div>
<div class="line">p = acq-&gt;GetPoint(<span class="stringliteral">&quot;RHEE&quot;</span>); <span class="comment">// Point with the label &#39;RHEE&#39;. Could throw an exception</span></div>
<div class="line">std::cout &lt;&lt; p-&gt;GetFrameNumber() &lt;&lt; std::endl;</div>
<div class="line"><a class="code" href="classbtk_1_1_acquisition.html#ac43457307a4240eb5523f59e82cdbcd8">btk::Acquisition::PointIterator</a> itP = acq-&gt;FindPoint(<span class="stringliteral">&quot;IS_THERE_A_POINT_WITH_THIS_LABEL&quot;</span>); <span class="comment">// Let&#39;s try to find this point ...</span></div>
<div class="line"><span class="keywordflow">if</span> (itP != acq-&gt;EndPoint()) <span class="comment">// Point found as the iterator doesn&#39;t point to the end of the list</span></div>
<div class="line">  std::cout &lt;&lt; (*itP)-&gt;GetValues() &lt;&lt; std::endl;</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">  std::cerr &lt;&lt; No point found &lt;&lt; std::endl;</div>
</div><!-- fragment --><p>When you know the iterator is valid, the best way to access to the content of the point is to use the following code <code>(*itP)-&gt;</code>. By using the code <code>*itP</code>. or <code>itP-&gt;</code>, you will access only to the methods of the shared pointer object (and not the pointed object by the shared pointer). This (little) drawback is due to the storage of pointers in the list instead of objects.</p>
<p>The use of an iterator has also an other main advantage. It gives you the possibility to access to all the point by iterating it. This gives you a simple and fast way to access to the points' data. To do this, you can use the methods <a class="el" href="classbtk_1_1_acquisition.html#a28ddb21f3544d7f6cc0afcd73176d6de">btk::Acquisition::BeginPoint()</a> and <a class="el" href="classbtk_1_1_acquisition.html#a7482e986158b36b52ff25db524a3d9a5">btk::Acquisition::EndPoint()</a>. </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;btkAcquisitionFileReader.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;btkPoint.h&gt;</span></div>
<div class="line"></div>
<div class="line">std::string GetPointTypeAsString(<a class="code" href="classbtk_1_1_point.html#ab1e04c0099a8b8e37564d8bcaca61af2">btk::Point::Type</a> t)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> (t == <a class="code" href="classbtk_1_1_point.html#ab1e04c0099a8b8e37564d8bcaca61af2adbd230522e504e1e258700a6d62ec312">btk::Point::Marker</a>)</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Marker&quot;</span>;</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t == <a class="code" href="classbtk_1_1_point.html#ab1e04c0099a8b8e37564d8bcaca61af2ae926b2bac58e7028c4adf41f7793c4c4">btk::Point::Angle</a>)</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Angle&quot;</span>;</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t == <a class="code" href="classbtk_1_1_point.html#ab1e04c0099a8b8e37564d8bcaca61af2aa1345f15190349efcdccd476c6fe82c6">btk::Point::Force</a>)</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Force&quot;</span>;</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t == <a class="code" href="classbtk_1_1_point.html#ab1e04c0099a8b8e37564d8bcaca61af2a9f6d6deb378f17baf5e52f27c0579cb2">btk::Point::Moment</a>)</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Moment&quot;</span>;</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t == <a class="code" href="classbtk_1_1_point.html#ab1e04c0099a8b8e37564d8bcaca61af2aa4f5f7093a4ac4155dd3f85f20f60f04">btk::Point::Power</a>)</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Power&quot;</span>;</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t == <a class="code" href="classbtk_1_1_point.html#ab1e04c0099a8b8e37564d8bcaca61af2a4751c28e8d07bd4c0ae8b50712857327">btk::Point::Scalar</a>)</div>
<div class="line">    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Scalar&quot;</span>;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// ...</span></div>
<div class="line">  <span class="comment">// btk::Acquisition::Pointer acq = ...</span></div>
<div class="line">  <span class="keywordflow">for</span> (<a class="code" href="classbtk_1_1_acquisition.html#a60f9d6149032900ef803cb43e8ee3d6a">btk::Acquisition::PointConstIterator</a> it = acq-&gt;BeginPoint() ; it != acq-&gt;EndPoint() ; ++it)</div>
<div class="line">  {</div>
<div class="line">    std::cout &lt;&lt; (*it)-&gt;GetLabel() &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; (*it)-&gt;GetDescription() &lt;&lt; <span class="stringliteral">&quot;): &quot;</span> &lt;&lt; GetPointTypeAsString((*it)-&gt;GetType());</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The code above, iterate in a <code>for</code> loop, the const iterator <code>it</code> from the first point (<code>it = acq-&gt;BeginPoint()</code>) to the last one (<code>it != acq-&gt;EndPoint()</code>), one by one (<code>++it</code>). The use of an <code>Iterator</code> or a <code>ConstIterator</code> depends of you need. An <code>Iterator</code> gives you the possibility to modify the associated object (see <a class="el" href="_getting_started.html#AcquisitionModifying">Modifying acquisition's data</a>), while a <code>ConstIterator</code> is a read-only iterator which is enough to access to the points' data.</p>
<h2><a class="anchor" id="AcquisitionAccessing_Analog"></a>
Accessing analog channels</h2>
<p>In an acquisition, analog channels are stored in a <a class="el" href="classbtk_1_1_collection.html#a42e1941a717a8c7079f6f797f5f12068">btk::AnalogCollection::Pointer</a> object. To access to this collection, you can use the method <a class="el" href="classbtk_1_1_acquisition.html#ad7bd2a7580144a7e3b59a3752e98415c">btk::Acquisition::GetAnalogs</a>.</p>
<p>The way to access to the analog channels is similar to the points. you can use the method <a class="el" href="classbtk_1_1_acquisition.html#ade5afe7cdec17c60b0aec3f3aa5c490b">btk::Acquisition::GetAnalog()</a> or an iterator (<a class="el" href="classbtk_1_1_acquisition.html#a8b8a317907a5679bd013c38c7e20f82b">btk::Acquisition::AnalogIterator</a>, <a class="el" href="classbtk_1_1_acquisition.html#a940e113c8beca92fbd2c9b30ecf65d14">btk::Acquisition::AnalogConstIterator</a> with the methods <a class="el" href="classbtk_1_1_acquisition.html#affbd41a8c8af73b34dd5e90e8f2e944d">btk::Acquisition::BeginAnalog()</a> and <a class="el" href="classbtk_1_1_acquisition.html#a8d40cfa4574f56ea8d250de0859d69f6">btk::Acquisition::EndAnalog()</a>). You can also use the method <a class="el" href="classbtk_1_1_acquisition.html#ab1d41c308831778c12d7d12d1dc14332">btk::Acquisition::FindAnalog()</a> if you don't know if the analog exists in the acquisition.</p>
<h2><a class="anchor" id="AcquisitionAccessing_Event"></a>
Accessing events</h2>
<p>In an acquisition, events are stored in a <a class="el" href="classbtk_1_1_collection.html#a42e1941a717a8c7079f6f797f5f12068">btk::EventCollection::Pointer</a> object. To access to this collection, you can use the method <a class="el" href="classbtk_1_1_acquisition.html#a3edf0793406e9f0f2ab2f04383d01893">btk::Acquisition::GetEvents</a>.</p>
<p>As the points and the analog channels, you can access to the events stored in an acquisition by using the method <a class="el" href="classbtk_1_1_acquisition.html#ad0f6bfebe3157fc4cc184617020882f8">btk::Acquisition::GetEvent()</a> or an iterator (<a class="el" href="classbtk_1_1_acquisition.html#ae2dbf2e5bc79f36b854d1db2452f2c30">btk::Acquisition::EventIterator</a>, <a class="el" href="classbtk_1_1_acquisition.html#afecf4b54f5a3ebaf360036bad2e5fae0">btk::Acquisition::EventConstIterator</a> with the methods <a class="el" href="classbtk_1_1_acquisition.html#a7b6fb261b9945d0a2ae9205514afd271">btk::Acquisition::BeginEvent()</a> and <a class="el" href="classbtk_1_1_acquisition.html#acc09bcdc450d21ff5474febc425692fd">btk::Acquisition::EndEvent()</a>). You can also use the method <a class="el" href="classbtk_1_1_acquisition.html#a83b48a37c5e43a85ce7cc2d3688ea2f3">btk::Acquisition::FindEvent()</a> if you don't know if the event exists in the acquisition.</p>
<h2><a class="anchor" id="AcquisitionAccessing_Metadata"></a>
Accessing metadata</h2>
<p>A metadata is a generic container to store the acquisition configuration. Or said differently, a metadata contains every informations which cannot be set into markers' trajectories nor analog channels' measures, nor events. For example, if you want to include subject's informations (sex, weight, height, ...) or force platform's configuration (corner's coordinates, analog channel used, ...), then the metadata are the right place to do this. In the C3D file format, the metadata are known as groups and parameters.</p>
<p>To access to the acquisition's metadata, you have to use the method <a class="el" href="classbtk_1_1_acquisition.html#af283db0ca3e918391c0a2d7d546993c0">btk::Acquisition::GetMetaData</a> which will return the root of the metadata. From this point, you have to use the methods of the class <a class="el" href="classbtk_1_1_meta_data.html" title="Store data which cannot be embedded within timeseries data (calibration matrix, subject informations...">btk::MetaData</a>. In the case where you want to access to the informations of a metadata, you will use the method <a class="el" href="classbtk_1_1_meta_data.html#abc95dce5f9a6569bd3d8ad04cfc53fc9">btk::MetaData::GetInfo</a>. This method returns a <a class="el" href="classbtk_1_1_meta_data_info.html#a804eaf0f7809c317539d42b0740006cb">btk::MetaDataInfo::Pointer</a> object which contains the values associated with the metadata.<br/>
For example, if you want to access to the value of the metadata SUBJECTS:WEIGHT, you can use the following code: </p>
<div class="fragment"><div class="line"><span class="comment">// btk::Acquisition::Pointer acq = ...</span></div>
<div class="line"><span class="keywordtype">double</span> weight = acq-&gt;GetMetaData()-&gt;GetChild(<span class="stringliteral">&quot;SUBJECTS&quot;</span>)-&gt;GetChild(<span class="stringliteral">&quot;WEIGHT&quot;</span>)-&gt;GetInfo()-&gt;ToDouble(0);</div>
</div><!-- fragment --><p> In the code above, the metadata WEIGHT is the child of the metadata SUBJECTS which is at the root of the metadata in the acquisition. It contains informations and at least one real value inside it.</p>
<p>Even if this code is the most direct way to access to a metadata and its information, it can thrown an exception if the metadata doesn't exist, or worst, can crash your app if there is no info (in this case, the method <a class="el" href="classbtk_1_1_meta_data.html#abc95dce5f9a6569bd3d8ad04cfc53fc9">btk::MetaData::GetInfo</a> returns an empty pointer). You can also extract the wrong (or corrupted) value, if this metadata is not used to store the weight as a real but as a string. The safe way to do this is the following: </p>
<div class="fragment"><div class="line"><span class="comment">// btk::Acquisition::Pointer acq = ...</span></div>
<div class="line"><span class="keywordtype">double</span> weight = 0.0;</div>
<div class="line"><a class="code" href="classbtk_1_1_meta_data.html#aa065fb2a06bb37ddf7f0e9f50799767e">btk::MetaData::ConstIterator</a> itG = acq-&gt;GetMetaData()-&gt;FindChild(<span class="stringliteral">&quot;SUBJECTS&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (itG != acq-&gt;EndMetaData()) <span class="comment">// SUBJECTS exists</span></div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classbtk_1_1_meta_data.html#aa065fb2a06bb37ddf7f0e9f50799767e">btk::MetaData::ConstIterator</a> itP = (*itG)-&gt;FindChild(<span class="stringliteral">&quot;WEIGHT&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (itP != (*itG)-&gt;End()) <span class="comment">// WEIGHT exists</span></div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">if</span> ((*itP)-&gt;HasInfo())</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classbtk_1_1_meta_data_info.html#a804eaf0f7809c317539d42b0740006cb">btk::MetaDataInfo::Pointer</a> swInfo = (*itP)-&gt;GetInfo();</div>
<div class="line">      <span class="keywordflow">if</span> (swInfo-&gt;GetFormat() == <a class="code" href="classbtk_1_1_meta_data_info.html#aa93033921435edbf927edf3972592eccaac920feb2ba264e89a25724f4e4b849d">btk::MetaDataInfo::Real</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">if</span> (swInfo-&gt;GetDimensions().size() == 0) <span class="comment">// Only one value in the metadata</span></div>
<div class="line">          weight = swInfo-&gt;ToDouble(0);</div>
<div class="line">      }  </div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p> This safe code can be summarized by the method <a class="el" href="classbtk_1_1_meta_data.html#a174bdae8f69f23d734198c1528fc1fbb">btk::MetaData::ExtractChildInfo()</a>. The corresponding code is the following. </p>
<div class="fragment"><div class="line"><span class="comment">// btk::Acquisition::Pointer acq = ...</span></div>
<div class="line"><span class="keywordtype">double</span> weight = 0.0;</div>
<div class="line"><a class="code" href="classbtk_1_1_meta_data.html#aa065fb2a06bb37ddf7f0e9f50799767e">btk::MetaData::ConstIterator</a> itG = acq-&gt;GetMetaData()-&gt;FindChild(<span class="stringliteral">&quot;SUBJECTS&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (itG != acq-&gt;EndMetaData()) <span class="comment">// SUBJECTS exists</span></div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classbtk_1_1_meta_data_info.html#a804eaf0f7809c317539d42b0740006cb">btk::MetaDataInfo::Pointer</a> swInfo = (*itG)-&gt;ExtractChildInfo(<span class="stringliteral">&quot;WEIGHT&quot;</span>, <a class="code" href="classbtk_1_1_meta_data_info.html#aa93033921435edbf927edf3972592eccaac920feb2ba264e89a25724f4e4b849d">btk::MetaDataInfo::Real</a>, 0); </div>
<div class="line">  <span class="keywordflow">if</span> (swInfo) <span class="comment">// Not an empty pointer</span></div>
<div class="line">    weight = swInfo-&gt;ToDouble(0);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="AcquisitionModifying"></a>
Modifying acquisition's data</h1>
<p>Starting from an acquisition you can easily modify it by, for example, removing points, adding events, resizing the number of frames, populates points or analogs values, etc. Lots of these actions are available by using the methods of the class <a class="el" href="classbtk_1_1_acquisition.html" title="Contains the data related to a biomechanical acquisition. ">btk::Acquisition</a>.</p>
<p>All the classes contains methods to modify their members. It is easy to extract a point from an acquisition and then set its label or description. This is the same for every object (including analogs channels, events or metadata).</p>
<div class="fragment"><div class="line"><span class="comment">// acq = ...</span></div>
<div class="line"><a class="code" href="classbtk_1_1_point.html#a62f1ac02e5140017676b23d91c3dc631">btk::Point::Pointer</a> foo = acq-&gt;GetPoint(0); <span class="comment">// Throw an exception if the point at the index 0 doesn&#39;t exist.</span></div>
<div class="line">foo-&gt;SetLabel(<span class="stringliteral">&quot;FOO&quot;</span>);</div>
<div class="line">foo-&gt;SetDescription(<span class="stringliteral">&quot;BAR&quot;</span>);</div>
<div class="line">foo-&gt;SetType(<a class="code" href="classbtk_1_1_point.html#ab1e04c0099a8b8e37564d8bcaca61af2ae926b2bac58e7028c4adf41f7793c4c4">btk::Point::Angle</a>);</div>
</div><!-- fragment --><p>In some case, these methods are not enough due to the complexity of the class. For example with the metadata, lots of methods were added to facilitate their creation with values (single or multiple values). It is the same if you want to extract them in a particular format (integer, float, double or string).</p>
<div class="fragment"><div class="line"><span class="comment">// acq = ...</span></div>
<div class="line"><a class="code" href="classbtk_1_1_meta_data.html#ab6eddda8f637b79415d23bcb3b93393c">btk::MetaData::Pointer</a> foo = <a class="code" href="classbtk_1_1_meta_data.html#a7dd8e23b4907e9754de3af5941f3ad2f">btk::MetaData::New</a>(<span class="stringliteral">&quot;FOO&quot;</span>, <span class="stringliteral">&quot;little description&quot;</span>);</div>
<div class="line"><span class="comment">// Check here that metadata FOO doesn&#39;t exist.</span></div>
<div class="line"><span class="comment">// If it is not the case, then it is not added and the method returns false. Otherwise it returns true.</span></div>
<div class="line">acq-&gt;GetMetaData()-&gt;AppendChild(foo);</div>
<div class="line"><span class="comment">// Even if the metadata are added in the object &#39;foo&#39;, it is also included in the acquisition as we are working with pointer.</span></div>
<div class="line">foo-&gt;AppendChild(<a class="code" href="classbtk_1_1_meta_data.html#a7dd8e23b4907e9754de3af5941f3ad2f">btk::MetaData::New</a>(<span class="stringliteral">&quot;BAR&quot;</span>,<span class="stringliteral">&quot;metadata with a string value&quot;</span>, <span class="stringliteral">&quot;another description&quot;</span>)); </div>
<div class="line">foo-&gt;AppendChild(<a class="code" href="classbtk_1_1_meta_data.html#a7dd8e23b4907e9754de3af5941f3ad2f">btk::MetaData::New</a>(<span class="stringliteral">&quot;JOB&quot;</span>, (int16_t)12, <span class="stringliteral">&quot;This is a metadata with an integer value&quot;</span>));</div>
<div class="line">foo-&gt;AppendChild(<a class="code" href="classbtk_1_1_meta_data.html#a7dd8e23b4907e9754de3af5941f3ad2f">btk::MetaData::New</a>(<span class="stringliteral">&quot;BAZ&quot;</span>, 180.0, <span class="stringliteral">&quot;And here a double&quot;</span>));</div>
<div class="line"><span class="comment">// To replace metadata&#39;s informations you can use the method btk::MetaData::SetInfo</span></div>
<div class="line">foo-&gt;GetChild(<span class="stringliteral">&quot;BAR&quot;</span>)-&gt;SetInfo(<a class="code" href="classbtk_1_1_meta_data_info.html#ab27a8f81be5a8a3914548158efffe312">btk::MetaDataInfo::New</a>((int8_t)64)); <span class="comment">// It is now a byte instead of a string.</span></div>
</div><!-- fragment --><p>Finally, in some case, you want to add children in the metadata but the requirement to check if they exist pollute your code, then you can use the functions <a class="el" href="group___b_t_k_common.html#ga0f6559030f4231054cbaa0701e1da8e4">btk::MetaDataCreateChild</a>. These functions declared in the file "btkMetaDataUtils.h" do for you the steps required to include a children in a metadata.</p>
<div class="fragment"><div class="line"><span class="comment">// From our previous example, the acquisition has the metadata FOO, FOO:BAR, FOO:JOB, FOO:BAZ</span></div>
<div class="line"><a class="code" href="classbtk_1_1_meta_data.html#ab6eddda8f637b79415d23bcb3b93393c">btk::MetaData::Pointer</a> foo = acq-&gt;GetMetaData()-&gt;GetChild(<span class="stringliteral">&quot;FOO&quot;</span>);</div>
<div class="line">foo-&gt;AppendChild(<a class="code" href="classbtk_1_1_meta_data.html#a7dd8e23b4907e9754de3af5941f3ad2f">btk::MetaData::New</a>(<span class="stringliteral">&quot;BAR&quot;</span>)); <span class="comment">// Will return false and don&#39;t append the metadata.</span></div>
<div class="line"><span class="comment">// Use this instead</span></div>
<div class="line"><a class="code" href="group___b_t_k_common.html#ga0f6559030f4231054cbaa0701e1da8e4">btk::MetaDataCreateChild</a>(foo, <span class="stringliteral">&quot;BAR&quot;</span>, <span class="stringliteral">&quot;It&#39;s working this case!&quot;</span>);</div>
<div class="line"><span class="comment">// It is also working if the child doesn&#39;t exist</span></div>
<div class="line"><a class="code" href="group___b_t_k_common.html#ga0f6559030f4231054cbaa0701e1da8e4">btk::MetaDataCreateChild</a>(foo, <span class="stringliteral">&quot;FOOBAR&quot;</span>, std::vector&lt;int8_t&gt;(2,0)); <span class="comment">// A new metadata with an array of bytes.</span></div>
</div><!-- fragment --><p><b>Note:</b> Even, if you can create an infinite level of metadata, it is strongly advised to only use 2 levels of metadata. The first one corresponds to groups (without informations) and the second one to parameters. This use was introduced in the C3D file format.</p>
<h1><a class="anchor" id="AcquisitionWriting"></a>
Writing an acquisition</h1>
<p>Saving an acquisition is as simple as reading one. If you want to save a modified acquisition or would like to convert a format into another one, you simply have to create an <a class="el" href="classbtk_1_1_acquisition_file_writer.html" title="Writer of acquisition data into acquisition file (C3D, TRC, ...). ">btk::AcquisitionFileWriter</a> object, plug the acquisition in the input, set the filename and update the process. </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> writeAcquisition(<a class="code" href="classbtk_1_1_acquisition.html#a121cd3751db496acdc3673fbe87da6e1">btk::Acquisition::Pointer</a> acq, <span class="keyword">const</span> std::string&amp; filename)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition_file_writer.html#a1562ddbabf938c5e3322a6d013587af0">btk::AcquisitionFileWriter::Pointer</a> writer = <a class="code" href="classbtk_1_1_acquisition_file_writer.html#a3237e546f5ca4021d27b731e23f98c5c">btk::AcquisitionFileWriter::New</a>();</div>
<div class="line">  writer-&gt;SetInput(acq)</div>
<div class="line">  writer-&gt;SetFilename(filename);</div>
<div class="line">  writer-&gt;Update();</div>
<div class="line">};</div>
</div><!-- fragment --><p> The choice of the format for the saving is based on the extension of the filename. But you can also set an AcquisitionIO as with the reader.</p>
<h1><a class="anchor" id="AcquisitionFiltering"></a>
Filtering an acquisition</h1>
<p>The library BTK offers a mechanism of pipelines to easily process an acquisition or one of these parts (points, analogs channels, etc.). A pipeline is defined as a collection of processes linked together by their input(s) and output(s). You can create loops, branches or any more complex workflow.</p>
<p>To link the output(s) and input(s) of processes, you have just to use the methods <code>SetInput()</code> and <code>GetOutput()</code>. Check the documentation of each class for more information.</p>
<p>When your pipeline is created, you need only to update the latest level of processes by using the method <code>Update()</code>. This process will check if all of these inputs are updated before to use them to generate its output. If these inputs are not updated, then the previous processes will be updated to be sure to use valid inputs.</p>
<p><b>Note:</b> You can also update a process by using its output (if it has one). Use its method <code>Update()</code>, and it will update its parent's process (can be useful when you prefer to store inputs/outputs instead of process).</p>
<h2><a class="anchor" id="ExampleSimpleAcquisitionConverter"></a>
Simple example: Acquisition file converter</h2>
<p>As a simple example, you can create a file converter. </p>
<div align="center">
<img src="dot_inline_dotgraph_2.png" alt="dot_inline_dotgraph_2.png" border="0" usemap="#dot_inline_dotgraph_2.map"/>
<map name="dot_inline_dotgraph_2.map" id="dot_inline_dotgraph_2.map"></map>
</div>
<p>The following code is based on the example <code>AcquisitionConverter</code>. Depending the given inputs, this code try to convert/save an acquisition file into another one. With this code, you can transform a C3D to a TRC file, or the reverse, etc. </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;btkAcquisitionFileReader.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;btkAcquisitionFileWriter.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;btkMacro.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">if</span> (argc != 3)</div>
<div class="line">  {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;No enough input arguements.\n\n&quot;</span></div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; btkStripPathMacro(argv[0]) &lt;&lt; <span class="stringliteral">&quot; input output\n\n&quot;</span></div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;Convert an acquisition file into another one, whatever the formats used.&quot;</span></div>
<div class="line">              &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// New instantiation of an acquisition file reader. </span></div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a279d2865e41e3600c9b2bf2ff07c0289">btk::AcquisitionFileReader::Pointer</a> reader = <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a4c76c7df065bf3dd5e52be868aafae5a">btk::AcquisitionFileReader::New</a>();</div>
<div class="line">  <span class="comment">// Set the path of the acquisition to read.</span></div>
<div class="line">  reader-&gt;SetFilename(argv[1]);</div>
<div class="line">  <span class="comment">// New instamtiation of an acquisition file writer</span></div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition_file_writer.html#a1562ddbabf938c5e3322a6d013587af0">btk::AcquisitionFileWriter::Pointer</a> writer = <a class="code" href="classbtk_1_1_acquisition_file_writer.html#a3237e546f5ca4021d27b731e23f98c5c">btk::AcquisitionFileWriter::New</a>();</div>
<div class="line">  <span class="comment">// Set the path of the file to write. The acquisition will be exported in this file.</span></div>
<div class="line">  writer-&gt;SetFilename(argv[2]);</div>
<div class="line">  <span class="comment">// Link the writer with the reader.</span></div>
<div class="line">  writer-&gt;SetInput(reader-&gt;GetOutput());</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Manage possible exceptions during the update of the pipeline.</span></div>
<div class="line">  <span class="keywordflow">try</span> </div>
<div class="line">  {</div>
<div class="line">    writer-&gt;Update();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">catch</span>(<a class="code" href="classbtk_1_1_exception.html">btk::Exception</a>&amp; e) <span class="comment">// General exception for BTK</span></div>
<div class="line">  {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception: &quot;</span> &lt;&lt; e.<a class="code" href="classbtk_1_1_exception.html#a301ff8986bde7093d4efbbadd05a8daa">what</a>() &lt;&lt; std::endl;</div>
<div class="line">    std::remove(argv[2]);    </div>
<div class="line">    <span class="keywordflow">return</span> -2;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">catch</span>(std::exception&amp; e) <span class="comment">// General exception for the STL</span></div>
<div class="line">  {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">    std::remove(argv[2]);    </div>
<div class="line">    <span class="keywordflow">return</span> -3;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">catch</span>(...) <span class="comment">// Should never happen ...</span></div>
<div class="line">  {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception&quot;</span>;</div>
<div class="line">    <span class="keywordflow">return</span> -3;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="ExampleLessSimpleAcquisitionMerger"></a>
Less simple example: Acquisition merger</h2>
<p>A more complex example, is the possibility to create a merger of acquisitions files, convert their units and write the new acquisition in a C3D file. </p>
<div align="center">
<img src="dot_inline_dotgraph_3.png" alt="dot_inline_dotgraph_3.png" border="0" usemap="#dot_inline_dotgraph_3.map"/>
<map name="dot_inline_dotgraph_3.map" id="dot_inline_dotgraph_3.map"></map>
</div>
<p>To create a such pipeline, we need to declare each process (readers, merger, converter and writer), link them and update the pipeline to generate the result.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;btkAcquisitionFileReader.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;btkMergeAcquisitionFilter.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;btkAcquisitionUnitConverter.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;btkAcquisitionFileWriter.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Declare each process</span></div>
<div class="line">  <span class="comment">// Readers</span></div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a279d2865e41e3600c9b2bf2ff07c0289">btk::AcquisitionFileReader::Pointer</a> TRBReader = <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a4c76c7df065bf3dd5e52be868aafae5a">btk::AcquisitionFileReader::New</a>();</div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a279d2865e41e3600c9b2bf2ff07c0289">btk::AcquisitionFileReader::Pointer</a> ANBReader= <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a4c76c7df065bf3dd5e52be868aafae5a">btk::AcquisitionFileReader::New</a>();</div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a279d2865e41e3600c9b2bf2ff07c0289">btk::AcquisitionFileReader::Pointer</a> CALForcePlateReader = <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a4c76c7df065bf3dd5e52be868aafae5a">btk::AcquisitionFileReader::New</a>();</div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a279d2865e41e3600c9b2bf2ff07c0289">btk::AcquisitionFileReader::Pointer</a> XLSOrthoTrakReader = <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a4c76c7df065bf3dd5e52be868aafae5a">btk::AcquisitionFileReader::New</a>();</div>
<div class="line">  <span class="comment">// Merger</span></div>
<div class="line">  <a class="code" href="classbtk_1_1_merge_acquisition_filter.html#a7eca894bf3ace808d1e26de2840ece57">btk::MergeAcquisitionFilter::Pointer</a> Merger = <a class="code" href="classbtk_1_1_merge_acquisition_filter.html#ad5dc8159022c74e6696ea83d691064d6">btk::MergeAcquisitionFilter::New</a>();</div>
<div class="line">  <span class="comment">// Converter</span></div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition_unit_converter.html#a5930f0684bb0f3508bdd3c2ff90b2375">btk::AcquisitionUnitConverter::Pointer</a> Converter = <a class="code" href="classbtk_1_1_acquisition_unit_converter.html#a6a436e80e9a1344201b77194464cb6c7">btk::AcquisitionUnitConverter::New</a>();</div>
<div class="line">  <span class="comment">// Writer</span></div>
<div class="line">  <a class="code" href="classbtk_1_1_acquisition_file_writer.html#a1562ddbabf938c5e3322a6d013587af0">btk::AcquisitionFileWriter::Pointer</a> C3DWriter = <a class="code" href="classbtk_1_1_acquisition_file_writer.html#a3237e546f5ca4021d27b731e23f98c5c">btk::AcquisitionFileWriter::New</a>();</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Link the processes together to create the pipeline</span></div>
<div class="line">  Merger-&gt;SetInput(0, TRBReader-&gt;GetOutput()); <span class="comment">// From the TRB reader to the merger</span></div>
<div class="line">  Merger-&gt;SetInput(1, ANBReader-&gt;GetOutput()); <span class="comment">// From the ANB reader to the merger</span></div>
<div class="line">  Merger-&gt;SetInput(2, CALForcePlateReader-&gt;GetOutput()); <span class="comment">// From the CAL reader to the merger</span></div>
<div class="line">  Merger-&gt;SetInput(3, XLSOrthoTrakReader-&gt;GetOutput()); <span class="comment">// From the XLS reader to the merger</span></div>
<div class="line">  Converter-&gt;SetInput(Merger-&gt;GetOutput()); <span class="comment">// From the merger to the converter</span></div>
<div class="line">  C3DWriter-&gt;SetInput(Converter-&gt;GetOutput()); <span class="comment">// From the converter to the C3D Writer;</span></div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Set the option(s) for each process</span></div>
<div class="line">  TRBReader-&gt;SetFilename(<span class="stringliteral">&quot;OneAcquisition.trb&quot;</span>);</div>
<div class="line">  ANBReader-&gt;SetFilename(<span class="stringliteral">&quot;OneAcquisition.anb&quot;</span>);</div>
<div class="line">  CALForcePlateReader-&gt;SetFilename(<span class="stringliteral">&quot;OneAcquisition.cal&quot;</span>);</div>
<div class="line">  XLSOrthoTrakReader-&gt;SetFilename(<span class="stringliteral">&quot;OneAcquisition.xls&quot;</span>);</div>
<div class="line">  <span class="comment">// No option for the merger</span></div>
<div class="line">  <span class="comment">// Use the default units for the converter: millimeter (position), degree (angle), newton (force), newton-millimeter (moment) and watt (power).</span></div>
<div class="line">  C3DWriter-&gt;SetFilename(<span class="stringliteral">&quot;OneAcquisition.c3d&quot;</span>);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// To execute the pipeline, it is only necessary to update the last process.</span></div>
<div class="line">  <span class="comment">// The pipeline will check if the previous are already updated an do it if necessary.</span></div>
<div class="line">  C3DWriter-&gt;Update();</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Now check in your folder and you will find a new C3D file!</span></div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">};</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Dec 27 2013 23:58:45 for BTK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>

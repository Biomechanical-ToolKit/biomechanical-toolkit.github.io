<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>BTK: Developer&#39;s guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="DoxygenStyleSheet_API.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BTK
   &#160;<span id="projectnumber">0.3dev.0</span>
   </div>
   <div id="projectbrief">Open-source library to visualize/process biomechanical data</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="classes.html"><span>Classes</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Developer's guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="btkmenu"><a class="el" href="index.html">Overview</a> | <a class="el" href="_build_instructions.html">Building instructions</a> | <a class="el" href="_getting_started.html">Getting started</a> | <a class="el" href="_advanced_tutorial.html">Advanced tutorial</a> | <b>Developer's</b> <b>guide</b> | <a class="el" href="_license.html">License</a> </div><h1><a class="anchor" id="TOC"></a>
Table of contents</h1>
<ul>
<li><a class="el" href="_developer.html#SupportedCompiler">Supported compiler</a></li>
<li><a class="el" href="_developer.html#ExtendBTK">Extend BTK</a></li>
<li><a class="el" href="_developer.html#TDD">Test drive development</a></li>
<li><a class="el" href="_developer.html#ProgrammingStyle">Programming style</a><ul>
<li><a class="el" href="_developer.html#CodingStyle">Coding style</a></li>
<li><a class="el" href="_developer.html#DoxygenDocumentation">Doxygen documentation</a></li>
</ul>
</li>
<li><a class="el" href="_developer.html#SVNBTK">Using SVN for BTK development</a><ul>
<li><a class="el" href="_developer.html#SourceCheckout">Source checkout</a></li>
<li><a class="el" href="_developer.html#SubmittingPatch">Submitting Patch</a></li>
</ul>
</li>
<li><a class="el" href="_developer.html#BugReports">Bug reports</a></li>
<li><a class="el" href="_developer.html#MailingList">Mailing list</a></li>
</ul>
 <hr> <h1><a class="anchor" id="SupportedCompiler"></a>
Supported compiler</h1>
<p>The code compiles without any warning nor error under the tested configurations:</p>
<ul>
<li>MacOS X 10.3 / GCC 3.3 (PPC 32 bits)</li>
<li>MacOS X 10.5 / GCC 4.0 (Intel 32/64 bits)</li>
<li>MacOS X 10.6 / GCC 4.2 (Intel 64 bits)</li>
<li>Ubuntu 9.04 "Jaunty" / GCC 4.3 (Intel 32 bits)</li>
<li>Ubuntu 10.04 "Lucid Lynx" / GCC 4.4 (Intel 64bits)</li>
<li>Ubuntu 10.10 "Maverick Meerkat" / GCC 4.5 (Intel 64 bits)</li>
<li>Windows XP SP3 / MSVC 2008 (Intel 32 bits)</li>
<li>Windows XP SP3 / MSVC 2010 (Intel 32 bits)</li>
<li>Windows Vista SP1 / MSVC 2010 (Intel 32 bits)</li>
<li>Windows 7 / Windows SDK 3.5 SP1 (Intel 64 bits)</li>
</ul>
<p>If your configuration is not listed here, please send an email to the <a href="http://groups.google.com/group/btk-users">mailing list</a> to report it.</p>
<h1><a class="anchor" id="ExtendBTK"></a>
Extend BTK</h1>
<p>As seen in the <a class="el" href="_advanced_tutorial.html">Advanced tutorial</a>, it is pretty easy to Write a new class using the existing classes in BTK. If you want to add your new class in the BTK source code, then you need to embed it in the CMake project. First, it is important to add your file(s) in the folder representing the module to extend.<br/>
Edit the file <code>CMakeLists.txt</code> found in the folder where you add your files and add the CPP file in the sources to compile. In the case where your class is only composed of header, then you don't have to add any filename in <code>CMakeLists.txt</code>.</p>
<p>For example, if you want to add the class <code>btk::EventDetector</code> composed of the files <code>btkEventDetector.h</code> and btkEventDetector.cpp in the module BasicFilters, then you have to:</p>
<ul>
<li>Add the files in the folder <code>Code/BasicFilters</code> </li>
<li>Edit the <code>CMakeLists.txt</code> in the folder <code>Code/BasicFilters</code> </li>
<li>Add in the CMake variable BTKBasicFilters_SRCS, the name of the CPP file. <pre class="fragment"># Part of the file  Code/BasicFilters/CMakeLists.txt
SET(BTKBasicFilters_SRCS
     btkAcquisitionUnitConverter.cpp
     btkEventDectector.cpp # &lt;-- New line added. Your class will be
compiled and integrated in the module BTKBasicFilters
     btkForcePlatformsExtractor.cpp
     btkForcePlatformWrenchFilter.cpp
     btkMergeAcquisitionFilter.cpp
     btkSeparateKnownVirtualMarkersFilter.cpp
     btkSpecializedPointsExtractor.cpp
     btkGroundReactionWrenchFilter.cpp
 )

ADD_LIBRARY(BTKBasicFilters ${BTK_LIBS_BUILD_TYPE} ${BTKBasicFilters_SRCS})

TARGET_LINK_LIBRARIES(BTKBasicFilters BTKCommon)
# ...
</pre></li>
</ul>
<p>For other extension (add a new wrapper, a new module, ...), please contact the developers by using the <a href="http://groups.google.com/group/btk-users">mailing list</a>. In some case, it is possible that a developer already starts the same extension without commit it as it is not enough mature and can help you.</p>
<h2><a class="anchor" id="TDD"></a>
Test drive development</h2>
<p>When developing a new class / function / method, it is strongly advised to write at the same time, some unit tests, or regression tests. These tests give the possibility to check if the behavior of the code corresponds to the desired results. And later, to be sure that the general behavior stays the same even if you refactor the code.</p>
<p>You will find more information using google: <a href="http://www.google.com/search?q=Test+Driven+Development">http://www.google.com/search?q=Test+Driven+Development</a></p>
<p>The library used in BTK to write the unit tests is a modified version of <a href="http://cxxtest.sourceforge.net/guide.html">CxxTest</a>. This code is embedded in the <code>Utilities</code> folder. The source code was modified to keep only the <code>ErrorPrinter</code> runner (no GUI) and add macros to generate the test runner instead of using Perl or Python.</p>
<p>Basically, the tests are defined in a suite of tests. So it is important to start by defining a suite by using the macro <code>CXXTEST_SUITE</code> and then, define inside the desired tests with the macro <code>CXXTEST_TEST</code>. </p>
<div class="fragment"><div class="line">CXXTEST_SUITE(C3DFileReaderTest)</div>
<div class="line">{</div>
<div class="line">  CXXTEST_TEST(NoFile)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a279d2865e41e3600c9b2bf2ff07c0289">btk::AcquisitionFileReader::Pointer</a> reader = <a class="code" href="classbtk_1_1_acquisition_file_reader.html#a4c76c7df065bf3dd5e52be868aafae5a">btk::AcquisitionFileReader::New</a>();</div>
<div class="line">    TS_ASSERT_THROWS_EQUALS(reader-&gt;Update(), <span class="keyword">const</span> <a class="code" href="classbtk_1_1_acquisition_file_reader_exception.html">btk::AcquisitionFileReaderException</a> &amp;e, e.<a class="code" href="classbtk_1_1_exception.html#a301ff8986bde7093d4efbbadd05a8daa">what</a>(), std::string(<span class="stringliteral">&quot;Filename must be specified&quot;</span>));</div>
<div class="line">  };</div>
<div class="line">};</div>
</div><!-- fragment --><p>Even if the suite and its test are defined you have to active them into the runner. This is done by using the macro <code>CXXTEST_SUITE_REGISTRATION</code> and <code>CXXTEST_TEST_REGISTRATION</code> to register the suite and the selected test respectively. </p>
<div class="fragment"><div class="line"><span class="comment">// ... Below the suite definition</span></div>
<div class="line">CXXTEST_SUITE_REGISTRATION(C3DFileReaderTest)</div>
<div class="line">CXXTEST_TEST_REGISTRATION(C3DFileReaderTest, NoFile)</div>
</div><!-- fragment --><p> To deactivate a test, you have only to comment its registration.</p>
<p>In BTK, the unit tests are in the <code>Testing/Code</code> folder. The <code>Testing/Data</code> folder contains input and output files used mainly by the tests for the modules IO and BasicFilters. To stay compatible with the current design, you have to write the tests' definition in a header file. Then this file is included in the <code>_TDD*</code> file associated with the module where your class was added. Now, compile the code and execute it to see if all the tests pass (you need to activate the option <a class="el" href="_build_instructions.html#config_test">BUILD_TESTING</a> in CMake).</p>
<p>The following list describes the contents of the files in the <code>Testing/Code</code> folder:</p>
<ul>
<li><code>_TDD.cpp</code> contains the <code>main</code> function where the test runner is executed ;</li>
<li><code>_TDDBasicFilters.cpp</code> contains the tests for the module BasicFilters ;</li>
<li><code>_TDDCommon.cpp</code> contains the tests for the module Common ;</li>
<li><code>_TDDConfigure.h.in</code> contains the required header to use CxxTest and the definition of the IO paths ;</li>
<li><code>_TDDIO.cpp</code> contains the tests for the module IO ;</li>
<li><code>*</code>.h All the tests.</li>
</ul>
<h1><a class="anchor" id="ProgrammingStyle"></a>
Programming style</h1>
<p>The following subsections explain how to format the syntax of the files for the code, and its documentation.</p>
<h2><a class="anchor" id="CodingStyle"></a>
Coding style</h2>
<ul>
<li>All the functions/classes embedded in BTK are in the namespace btk.</li>
<li>The file extension used for the C++ header is <code></code>.h</li>
<li>The file extension used for the C++ source is <code></code>.cpp</li>
<li>Indentation with 2 spaces, no tabs ;</li>
<li>The comparison use the right-hand comparison (as modern compiler, at least GCC, can detect the use of the assignment operation <code>instead</code> of the equal operator <code>==</code>) ;</li>
<li>Use explicitly parentheses into conditional statement or other logical expression</li>
<li>Private function/class finishes by the suffix <code>_p</code> ;</li>
<li>Use explicit names rather than short names ;</li>
<li>Use the <a href="https://en.wikipedia.org/wiki/Allman_style#Allman_style">Allman style</a> to indent the code ;</li>
<li>Comments have to be written in english as it is the language that nearly all programmers in all countries can read.</li>
</ul>
<h2><a class="anchor" id="DoxygenDocumentation"></a>
Doxygen documentation</h2>
<p>To keep clean the headers, it has been chosen to write the documentation into the definition part of the code (in most of the case, in the CPP file).</p>
<p>The Doxygen documentation uses the JavaDoc style and the Doxygen command use the arobase <code>@</code> instead of the backslash <code>\</code> character. For example: </p>
<pre class="fragment">/**
 * @class Acquisition btkAcquisition.h
 * @brief Contains the data related to a biomechanical acquisition.
 *
 * A biomechanical acquisition can contains:
 *  - 3D data (makers, points, forces, moments, ...) ;
 *  - analog channels (force platform, emg, ...) ;
 *  - events
 *  - acquisition's setup ;
 *  - subject's informations.
 *
 * @ingroup BTKCommon
 */
</pre><p>Every function / class / method or member (public and protected) must have a block of documentation with at least a description and set into a module (using the command <code>@ingroup</code>). The known modules are listed in <code>Modules</code> page and reported here:</p>
<ul>
<li>BTKCommon</li>
<li>BTKIO</li>
<li>BTKBasicFilters</li>
<li>BTKVTK</li>
</ul>
<p>A class must have also a brief description to be included in the <code>Class Index</code> page.</p>
<p>If you need to add references into the description, then you can add the name of the authors ans the date between parenthesis (e.g. Foo et al, 2009 ; Bar &amp; Foo, 2010) and add a paragraph named <em>Reference</em> at the end of the description. This paragraph will contain the details of the reference(s). The format should be:</p>
<ul>
<li>List of authors (Authors1, initial(s) ; Authors2, initial(s) ; ...)</li>
<li>Title in italic (<em>The name or the article</em>.)</li>
<li>Name of the journal, Number (Issue), <b>date</b>, pages.</li>
</ul>
<p>For example: </p>
<pre class="fragment">@par Reference
Shimba T.@n
&lt;em&gt;An estimation of center of gravity from force platform data&lt;/em&gt;.@n
Journal of Biomechanics, &lt;b&gt;1984&lt;/b&gt;, 17(1), 53–60.
</pre><p>which gives the results: </p>
<dl class="section user"><dt>Reference</dt><dd>Shimba T.<br/>
<em>An estimation of center of gravity from force platform data</em>.<br/>
Journal of Biomechanics, <b>1984</b>, 17(1), 53–60.</dd></dl>
<h1><a class="anchor" id="SVNBTK"></a>
Using SVN for BTK development</h1>
<p>The library BTK uses <a href="http://subversion.apache.org/">Subversion</a> (SVN) to manage files and directories, and the changes made to them, over time. You can use the following free clients to checkout the code.</p>
<ul>
<li><a href="http://tortoisesvn.tigris.org/">TortoiseSVN</a> (Windows only)</li>
<li><a href="http://kdesvn.alwins-world.de/">KDESvn</a> (Linux only)</li>
<li><a href="http://www.syntevo.com/smartsvn/index.html">SmartSVN</a> (Win/Mac/Linux)</li>
<li><a href="http://developer.apple.com">XCode</a> (MacOS X only)</li>
</ul>
<p>For an exhaustive list of the Subversion clients, you can check this <a href="http://en.wikipedia.org/wiki/Comparison_of_Subversion_clients">page</a> on Wikipedia.</p>
<p>The code is hosted by google and can be browsed <a href="http://code.google.com/p/b-tk/source/browse/#svn/BTK/trunk">here</a>. It lists the trunk (the default branch) and its folder. If you prefer, you can also access to the list of <a href="http://code.google.com/p/b-tk/source/list">changes</a>.</p>
<h2><a class="anchor" id="SourceCheckout"></a>
Source checkout</h2>
<p>The URL to use in the SVN client to download the latest source code for the trunk is the following: <a href="http://b-tk.googlecode.com/svn/BTK/trunk">http://b-tk.googlecode.com/svn/BTK/trunk</a>. This URL gives you a read-only access to the source code. Only the members can commit into the source code.</p>
<h2><a class="anchor" id="SubmittingPatch"></a>
Submitting Patch</h2>
<p>If you add a functionality, fix a bug, add some documentation or correct it (or ...) and want to share it with the community, you can create a patch and send it to the <a href="http://groups.google.com/group/btk-users">mailing list</a>. To create a patch, few rules must be respected to be able to apply this patch easily.</p>
<ul>
<li>Update your working directory to be sure to create patch against the last revision. If it is not the case, it can create one or more conflicts in the code and finally gives errors during the compilation or worster, crash the final application.</li>
<li>Create a patch from the top of the sources (the root) or at least indicate from which folder you create the patch.</li>
</ul>
<p><b>Note:</b> For TortoiseSVN user, check this <a href="http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-patch.html">help</a> to create patch.</p>
<h1><a class="anchor" id="BugReports"></a>
Bug reports</h1>
<p>For bug reports and feature requests, please use the <a href="http://code.google.com/p/b-tk/issues/list">issue tracker</a>. It gives you a list of the opened issues. Check the closed issues (Select "All issues" instead of "Open issues" and click on search) before submitting a new one.</p>
<h1><a class="anchor" id="MailingList"></a>
Mailing list</h1>
<p>For the moment, it exists one mailing list where users and developers can write to each other. If necessary this mailing list could be splitted to separate user and developer discussions.</p>
<p>Check the mailing list <a href="http://groups.google.com/group/btk-users">BTK Users</a> to subscribe or access to the archives </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Dec 27 2013 23:58:44 for BTK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
